# Production mode

The goal of the production mode is to have a second way to execute your code. With it you have 2 ways of executing your code:

1. _development mode_
2. _production mode_

In _development mode_ you can do things specific to development and in _production mode_ do things specific to production.

importmap can be used controls how the imports are resolved. Let's take an example with some js.

```js
import { DEV } from "#env"

const message = DEV ? "development" : "production"
document.querySelector("#message").innerHTML = message
```

Depending on HTML files, browser displays either _development_ or _production_.

| [dev.html](./demo/dev.html)     | [prod.html](./demo/prod.html)    |
| ------------------------------- | -------------------------------- |
| ![stuff](./mode_dev_chrome.png) | ![stuff](./mode_prod_chrome.png) |

This repository has preconfigured a _production mode_, if you want to keep this ability, check [How to use production mode](#how-to-use-production-mode). Otherwise see [How to remove production mode](#how-to-remove-production-mode).

# How to use production mode

This repository generates multiple importmaps depending how you want to execute your code. Import map files are generated by _npm run generate-importmap_.

| importmap file                | Description                                                                   | File using it                                                   |
| ----------------------------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------- |
| importmap.prod.importmap      | Remap imports in production mode                                              | [main.html](../../main.html#L10)                                |
| importmap.dev.importmap       | Remap imports in development mode                                             | [test/greet.dev.test.html](../../test/greet.dev.test.html#L8)   |
| importmap.prod.test.importmap | Remap imports in production mode + contains remapping for `"devDependencies"` | [test/greet.prod.test.html](../../test/greet.prod.test.html#L8) |

# How to remove production mode

1. Remove all `#env` imports in files
2. Remove `"initialImportMap"` in [script/importmap/generate_importmap.mjs](../../script/importmap/generate_importmap.mjs#L11)
3. Delete [env.prod.js](../../env.prod.js)
4. Delete [env.dev.js](../../env.dev.js)
