System.register([],(function(e,t){"use strict";return{execute:function(){const n=(e,t,n)=>(e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}),o=e=>(window.addEventListener("appinstalled",e),()=>{window.removeEventListener("appinstalled",e)}),a=()=>window.navigator.standalone||window.matchMedia("(display-mode: standalone)").matches,i=e=>{const t=window.matchMedia("(display-mode: standalone)");return t.addListener(e),()=>{t.removeListener(e)}};let r=!1;o((()=>{r=!0}));const l={isAvailable:()=>!!window.beforeinstallpromptEvent&&(!a()&&!r),listenAvailabilityChange:e=>{let t=l.isAvailable();const n=()=>{const n=l.isAvailable();n!==t&&(t=n,e(n))},a=s((e=>{window.beforeinstallpromptEvent=e,n()})),c=i((()=>{n()})),d=o((()=>{r=!0,n()}));return()=>{a(),c(),d()}},prompt:async()=>{if(!window.beforeinstallpromptEvent)return console.warn("cannot prompt add to home screen: window.beforeinstallpromptEvent is missing"),!1;window.beforeinstallpromptEvent.prompt();return"accepted"===(await window.beforeinstallpromptEvent.userChoice).outcome}},s=e=>n(window,"beforeinstallprompt",e),c=window.navigator.serviceWorker,d=Boolean(c)&&"https:"===document.location.protocol;let u=null,p=null;const w=(()=>{let e=[];return{listen:(t,{once:n=!1}={})=>{if(n){const e=t;t=(...t)=>{a(),e(...t)}}e=[...e,t];let o=!1;const a=()=>{if(o)return;o=!0;const n=[];let a=e.length,i=!0;for(;a--;){const o=e[a];i&&o===t?i=!1:n.push(o)}e=n};return a},emit:(...t)=>{e.forEach((e=>{e(...t)}))}}})(),m=e=>{p&&p===e||(e&&e.state,p=e,w.emit())},v=e=>{if(p)return((e,t)=>{const{port1:n,port2:o}=new MessageChannel;return new Promise(((a,i)=>{n.onmessage=function(e){"rejected"===e.data.status?i(e.data.value):a(e.data.value)},e.postMessage(t,[o])}))})(p,e);console.warn("no service worker updating to send message to")},g=async(e,{onActivating:t=(()=>{}),onActivated:o=(()=>{}),onBecomesNavigatorController:a=(()=>{})}={})=>{const{state:i}=e;if("installed"!==i&&"activating"!==i)a(),m(null),h();else if("installed"===i&&v({action:"skipWaiting"}),await new Promise((a=>{const i=n(e,"statechange",(()=>{"activating"===e.state&&t(),"activated"===e.state&&(o(),i(),a())}))})),c.controller){const e=n(c,"controllerchange",(()=>{e(),a(),m(null),h()}))}else m(null),h()};let b=!0,f=!1;const h=()=>{f||(f=!0,window.location.reload())};d&&n(c,"controllerchange",h);const y=new URL(System.resolve("./service_worker2.js",t.meta.url)),E=e=>{if(!d)return;(window.requestIdleCallback||requestAnimationFrame)((()=>{((e,t)=>{if(!d)return()=>{};let o=!1,a=()=>{},i=()=>{};u=c.register(e,t),(async()=>{const e=await u;if(a=()=>{e.unregister()},o)return void a();const{installing:t,waiting:r,active:l}=e;i=n(e,"updatefound",(()=>{e.installing!==t&&m(e.installing)}))})()})(y)})),L(e)},L=e=>{const t=document.createElement("button");t.innerHTML="Check update";const n=document.createElement("p");var o;e.appendChild(t),e.appendChild(n),t.onclick=async()=>{t.disabled=!0,n.innerHTML="checking for update";await(async()=>{if(!u)return console.warn("registerServiceWorker must be called before checkServiceWorkerUpdate can be used"),!1;const e=await u,t=await e.update(),{installing:n}=t;if(n)return m(n),!0;const{waiting:o}=t;return!!o&&(m(o),!0)})()||(t.disabled=!1,n.innerHTML="No update available")},o=()=>{Boolean(p?{shouldBecomeNavigatorController:Boolean(c.controller),navigatorWillReload:b}:null)?(n.innerHTML="Update available <button>Activate update</button>",n.querySelector("button").onclick=async()=>{n.querySelector("button").disabled=!0,await(async e=>{if(!p)throw new Error("no service worker update to activate");return g(p,e)})()}):n.innerHTML=""},w.listen(o)},k=e=>{(e=>{const t=document.createElement("button");t.disabled=!l.isAvailable(),t.innerHTML="Add to home screen",e.appendChild(t),t.onclick=()=>{l.prompt()},l.listenAvailabilityChange((()=>{t.disabled=!l.isAvailable()}))})(e),E(e)},A=document.querySelector("#app");e("render",(()=>{const e=new URL(System.resolve("./assets/logo.png",t.meta.url));A.innerHTML=`\n<img src=${e} width="64" height="64" alt="jsenv logo" />\n<p>Welcome</p>`,k(A)}))}}}));

//# sourceMappingURL=app_0ee83b05.js.map