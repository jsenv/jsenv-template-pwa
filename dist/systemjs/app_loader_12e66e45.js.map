{
  "version": 3,
  "file": "app_loader.js",
  "sources": [
    "../../src/app_loader/app_loader_utils.js",
    "../../src/app_loader/app_loader.js"
  ],
  "sourcesContent": [
    "export const loadCSSAndFonts = async (\n  cssUrl,\n  { timeout = 1000, onCssReady = () => {}, onFontsReady = () => {} } = {},\n) => {\n  const loadedPromise = (async () => {\n    try {\n      await injectCSS(cssUrl)\n      onCssReady()\n      if (onFontsReady) {\n        await document.fonts.ready\n        onFontsReady()\n      }\n    } catch (e) {\n      return\n    }\n  })()\n  return Promise.race([\n    loadedPromise,\n    new Promise((resolve) => {\n      setTimeout(resolve, timeout)\n    }),\n  ])\n}\n\nconst injectCSS = (cssUrl, { crossOrigin } = {}) => {\n  return new Promise((resolve, reject) => {\n    const link = document.createElement(\"link\")\n    link.rel = \"stylesheet\"\n    link.onload = resolve\n    link.onerror = reject\n    link.href = cssUrl\n    link.crossOrigin = crossOrigin\n    document.head.appendChild(link)\n  })\n}\n\nexport const nextIDLEPromise = window.requestIdleCallback\n  ? ({ timeout = 60 } = {}) => {\n      return new Promise((resolve) => {\n        window.requestIdleCallback(resolve, { timeout })\n      })\n    }\n  : () => {\n      return new Promise((resolve) => {\n        window.requestAnimationFrame(resolve)\n      })\n    }\n",
    "/**\n * This is where you can orchestrate the loading of your application\n */\n\nimport { DEV } from \"#env\"\nimport { loadCSSAndFonts, nextIDLEPromise } from \"./app_loader_utils.js\"\n\nexport const loadApp = async ({ updateSplashscreenText }) => {\n  if (DEV) {\n    performance.measure(`loading app`)\n  }\n\n  // try to load CSS + get the main fonts before displaying any text\n  // to avoid font swapping if possible\n  // give max 400ms for this\n  const appLoaderCssPromise = loadCSSAndFonts(\n    new URL(\"./app_loader.css\", import.meta.url),\n    {\n      timeout: 400,\n      onCssReady: () => {\n        if (DEV) {\n          performance.measure(`app_loader.css ready`)\n        }\n      },\n      onFontsReady: () => {\n        if (DEV) {\n          performance.measure(`fonts ready`)\n        }\n      },\n    },\n  )\n  // start importing app right away\n  const appPromise = importApp({\n    onJsReady: () => {\n      if (DEV) {\n        performance.measure(\"app.js ready\")\n      }\n    },\n  })\n  const appCSSPromise = loadCSSAndFonts(\n    new URL(\"../app/app.css\", import.meta.url),\n    {\n      onCssReady: () => {\n        if (DEV) {\n          performance.measure(`app.css ready`)\n        }\n      },\n    },\n  )\n\n  await appLoaderCssPromise\n  await updateSplashscreenText(`Loading banana...`)\n  if (DEV) {\n    performance.measure(`\"loading bannana...\" displayed`)\n  }\n  await new Promise((resolve) => {\n    setTimeout(resolve, 800)\n  })\n\n  updateSplashscreenText(`Loading gorilla...`)\n  if (DEV) {\n    performance.measure(`\"loading gorilla...\" displayed`)\n  }\n  await new Promise((resolve) => {\n    setTimeout(resolve, 1000)\n  })\n\n  updateSplashscreenText(`Loading the entire jungle...`)\n  if (DEV) {\n    performance.measure(`\"entire jungle...\" displayed`)\n  }\n  await new Promise((resolve) => {\n    setTimeout(resolve, 1200)\n  })\n\n  const app = await appPromise\n  if (DEV) {\n    performance.measure(`rendering app`)\n  }\n  app.render()\n  await appCSSPromise\n  // app.render() can be very expensive so we wait a bit\n  // to let navigator an opportunity to cooldown\n  // This should help to save battery power and RAM\n  await nextIDLEPromise()\n  if (DEV) {\n    performance.measure(`app rendered`)\n  }\n}\n\nconst importApp = async ({ onJsReady = () => {} }) => {\n  const app = await import(\"../app/app.js\")\n  onJsReady()\n  return app\n}\n"
  ],
  "names": [
    "f",
    "args",
    "i",
    "arguments",
    "length",
    "Promise",
    "resolve",
    "apply",
    "this",
    "e",
    "reject",
    "value",
    "then",
    "direct",
    "body",
    "result",
    "recover",
    "loadCSSAndFonts",
    "cssUrl",
    "timeout",
    "onCssReady",
    "onFontsReady",
    "loadedPromise",
    "_async",
    "injectCSS",
    "document",
    "fonts",
    "ready",
    "race",
    "setTimeout",
    "crossOrigin",
    "link",
    "createElement",
    "rel",
    "onload",
    "onerror",
    "href",
    "head",
    "appendChild",
    "nextIDLEPromise",
    "window",
    "requestIdleCallback",
    "requestAnimationFrame",
    "updateSplashscreenText",
    "appLoaderCssPromise",
    "appPromise",
    "importApp",
    "onJsReady",
    "appCSSPromise",
    "app",
    "render",
    "module"
  ],
  "mappings": "oFAsEuBA,UACf,eACD,IAAIC,EAAO,GAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAChDD,EAAKC,GAAKC,UAAUD,cAGbG,QAAQC,QAAQN,EAAEO,MAAMC,KAAMP,IACpC,MAAMQ,UACAJ,QAAQK,OAAOD,gBAMFE,EAAOC,EAAMC,UAC/BA,EACID,EAAOA,EAAKD,GAASA,GAExBA,GAAUA,EAAMC,OACpBD,EAAQN,QAAQC,QAAQK,IAElBC,EAAOD,EAAMC,KAAKA,GAAQD,4BA+cHG,OAC1BC,EAASD,OACTC,GAAUA,EAAOH,YACbG,EAAOH,mBAKOE,EAAME,WAEvBD,EAASD,IACZ,MAAML,UACAO,EAAQP,UAEZM,GAAUA,EAAOH,KACbG,EAAOH,UAAK,EAAQI,GAErBD,aAhdyBJ,MAC5BA,GAASA,EAAMC,YACXD,EAAMC,cA7GFK,cACXC,gEACqE,OAAnEC,QAAAA,aAAU,UAAMC,WAAAA,aAAa,aAAUC,aAAAA,aAAe,eAElDC,EAAgBC,8CAEZC,EAAUN,sBAChBE,qBACIC,WACII,SAASC,MAAMC,kBACrBN,kCANgBE,UAYflB,QAAQuB,KAAK,CAClBN,EACA,IAAIjB,SAASC,IACXuB,WAAWvB,EAASa,WAKpBK,EAAY,SAACN,gEAA0B,GAAhBY,IAAAA,mBACpB,IAAIzB,SAAQ,CAACC,EAASI,WACrBqB,EAAON,SAASO,cAAc,QACpCD,EAAKE,IAAM,aACXF,EAAKG,OAAS5B,EACdyB,EAAKI,QAAUzB,EACfqB,EAAKK,KAAOlB,EACZa,EAAKD,YAAcA,EACnBL,SAASY,KAAKC,YAAYP,OAIjBQ,EAAkBC,OAAOC,oBAClC,wEAAoB,OAAjBtB,QAAAA,aAAU,YACJ,IAAId,SAASC,IAClBkC,OAAOC,oBAAoBnC,EAAS,CAAEa,QAAAA,QAG1C,IACS,IAAId,SAASC,IAClBkC,OAAOE,sBAAsBpC,iBCwCdK,EAAOC,EAAMC,UAC/BA,EACID,EAAOA,EAAKD,GAASA,GAExBA,GAAUA,EAAMC,OACpBD,EAAQN,QAAQC,QAAQK,IAElBC,EAAOD,EAAMC,KAAKA,GAAQD,cArBXX,UACf,eACD,IAAIC,EAAO,GAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAChDD,EAAKC,GAAKC,UAAUD,cAGbG,QAAQC,QAAQN,EAAEO,MAAMC,KAAMP,IACpC,MAAMQ,UACAJ,QAAQK,OAAOD,oCAvEOkC,IAAAA,6BAQxBC,EAAsB3B,EAC1B,8DACA,CACEE,QAAS,IACTC,WAAY,OAKZC,aAAc,SAQZwB,EAAaC,EAAU,CAC3BC,UAAW,SAMPC,EAAgB/B,EACpB,uDACA,CACEG,WAAY,kBAQVwB,uBACAD,4CAIA,IAAItC,SAASC,IACjBuB,WAAWvB,EAAS,2BAGtBqC,0BAIM,IAAItC,SAASC,IACjBuB,WAAWvB,EAAS,2BAGtBqC,oCAIM,IAAItC,SAASC,IACjBuB,WAAWvB,EAAS,8BAGJuC,YAAZI,UAINA,EAAIC,WACEF,8BA+bclC,EAAMF,EAAMC,MAC7BA,SACID,EAAOA,EAAKE,KAAUA,YAGzBC,EAASV,QAAQC,QAAQQ,YACtBF,EAAOG,EAAOH,KAAKA,GAAQG,EACjC,MAAON,UACDJ,QAAQK,OAAOD,KAnchB8B,iDAMFO,yBAAqBC,UAAAA,aAAY,kBACnBI,SAAO,sBAAnBF,UACNF,IACOE"
}